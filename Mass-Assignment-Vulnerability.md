# Lab: Exploiting a Mass Assignment Vulnerability

> This lab demonstrates how insecure mass assignment can be exploited to manipulate application behavior and gain unauthorized privileges.

##  Goal

Exploit a mass assignment vulnerability to apply a 100% discount and successfully purchase the **Lightweight "l33t" Leather Jacket** using user credentials.

##  Tools Used

- Burp Suite (Community or Pro)
- Firefox or any proxy-configured browser
- PortSwigger Lab Environment

##  Steps to Reproduce

1. Login to the application using the credentials: wiener:peter
2. Add product to cart:
- Select **Lightweight "l33t" Leather Jacket**.
- Click on **Add to Basket**.

3. Click "Place order" and note that you donâ€™t have enough credit.

4. In Burp Suite, go to `Proxy > HTTP history` and observe both:
- `GET /api/checkout`
- `POST /api/checkout`

5. **Observe the GET response:**
- The JSON includes a hidden parameter:
  ```json
  "chosen_discount": {
      "percentage": 0
  }
  ```

6. Send POST request to Repeater in Burp.

7. Modify the JSON body in the Repeater tab:
```json
{
  "chosen_discount": {
    "percentage": 100
  },
  "chosen_products": [
    {
      "product_id": "1",
      "quantity": 1
    }
  ]
}
```
send the request and reload page in browser and  place the order to solve the lab.
